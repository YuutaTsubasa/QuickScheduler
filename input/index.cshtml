Title: "快速週表產生器"
OutsidePageContent: true
---
<section class="data_form">
    <div><label for="startDate">開始時間：</label><input type="date" id="startDate" /></div>
    <div><label for="backgroundColor">背景顏色：</label><input type="color" id="backgroundColor" /></div>
    <div><label for="coverArt">封面圖：</label><input type="text" id="coverArt" /></div>
    <div><label for="coverDescription">封面說明：</label><input type="text" id="coverDescription" /></div>
    
    <div class="daySetting">
        <div><label for="day1Style">第一天直播樣式：</label>
            <select name="day1Style" id="day1Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day1Title">第一天直播標題：</label><input type="text" id="day1Title" /></div>
        <div><label for="day1Tag">第一天直播標籤（以 , 隔開）：</label><input type="text" id="day1Tag" /></div>
        <div><label for="day1Time">第一天直播時間：</label><input type="text" id="day1Time" /></div>
    </div>
    
    <div class="daySetting">
        <div><label for="day2Style">第二天直播樣式：</label>
            <select name="day2Style" id="day2Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day2Title">第二天直播標題：</label><input type="text" id="day2Title" /></div>
        <div><label for="day2Tag">第二天直播標籤（以 , 隔開）：</label><input type="text" id="day2Tag" /></div>
        <div><label for="day2Time">第二天直播時間：</label><input type="text" id="day2Time" /></div>
    </div>

    <div class="daySetting">
        <div><label for="day3Style">第三天直播樣式：</label>
            <select name="day3Style" id="day3Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day3Title">第三天直播標題：</label><input type="text" id="day3Title" /></div>
        <div><label for="day3Tag">第三天直播標籤（以 , 隔開）：</label><input type="text" id="day3Tag" /></div>
        <div><label for="day3Time">第三天直播時間：</label><input type="text" id="day3Time" /></div>
    </div>
    
    <div class="daySetting">
        <div><label for="day4Style">第四天直播樣式：</label>
            <select name="day4Style" id="day4Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day4Title">第四天直播標題：</label><input type="text" id="day4Title" /></div>
        <div><label for="day4Tag">第四天直播標籤（以 , 隔開）：</label><input type="text" id="day4Tag" /></div>
        <div><label for="day4Time">第四天直播時間：</label><input type="text" id="day4Time" /></div>
    </div>

    <div class="daySetting">
        <div><label for="day5Style">第五天直播樣式：</label>
            <select name="day5Style" id="day5Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day5Title">第五天直播標題：</label><input type="text" id="day5Title" /></div>
        <div><label for="day5Tag">第五天直播標籤（以 , 隔開）：</label><input type="text" id="day5Tag" /></div>
        <div><label for="day5Time">第五天直播時間：</label><input type="text" id="day5Time" /></div>
    </div>

    <div class="daySetting">
        <div><label for="day6Style">第六天直播樣式：</label>
            <select name="day6Style" id="day6Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day6Title">第六天直播標題：</label><input type="text" id="day6Title" /></div>
        <div><label for="day6Tag">第六天直播標籤（以 , 隔開）：</label><input type="text" id="day6Tag" /></div>
        <div><label for="day6Time">第六天直播時間：</label><input type="text" id="day6Time" /></div>
    </div>

    <div class="daySetting">
        <div><label for="day7Style">第七天直播樣式：</label>
            <select name="day7Style" id="day7Style">
                <option value="work">工作</option>
                <option value="holiday">假日</option>
            </select>
        </div>
        <div><label for="day7Title">第七天直播標題：</label><input type="text" id="day7Title" /></div>
        <div><label for="day7Tag">第七天直播標籤（以 , 隔開）：</label><input type="text" id="day7Tag" /></div>
        <div><label for="day7Time">第七天直播時間：</label><input type="text" id="day7Time" /></div>
    </div>
</section>

<button id="download_weekly">下載週表 (不支援 iOS)</button>
<section class="weekly_container">
    <section class="weekly">
        <section class="weekly_left_part">
            <div class="weekly_author_part"></div>
        </section>
        <section class="weekly_right_part">
            <h1>本週行事曆</h1>
            <ul class="weekly_items">
                @foreach(var index in Enumerable.Range(0, 7)){
                    <li class="weekly_item">
                    <div class="weekly_item_date"><span class="content_part"><span class="date_part">00/00</span><span class="time_part">(X) 00:00</span></span></div>
                        @* @if (dayWithItem.Item.ContainsKey("Title")){
                            <div class="content">
                                <ul class="weekly_tags">
                                    @foreach(var tag in dayWithItem.Item["Tags"].Split(',')){ 
                                        <li>@tag</li> 
                                    }
                                </ul>
                                @dayWithItem.Item["Title"]
                            </div>
                        }
                        else { *@
                            <div class="content stream_off"></div>
                        @* }
                    *@
                    </li>
                }
            </ul>
            @* <nav class="weekly_community">
                <ul>
                    <li><a class="twitter" href="https://yutaii.run/twitter" target="_blank"><img src="/images/community_logo/twitter.svg" alt="Twitter Logo" class="logo"/> YuutaTsubasa</a></li>
                    <li><a class="youtube" href="https://yutaii.run/youtube" target="_blank"><img src="/images/community_logo/youtube.svg" alt="Youtube Logo" class="logo"/> @@YuutaTsubasa</a></li>
                    <li><a class="facebook" href="https://yutaii.run/facebook" target="_blank"><img src="/images/community_logo/facebook.svg" alt="Facebook Logo" class="logo"/>悠太翼</a></li>
                    <li><a class="instagram" href="https://yutaii.run/instagram" target="_blank"><img src="/images/community_logo/instagram.svg" alt="Instagram Logo" class="logo"/>yuutatsubasa</a></li>
                    <li><a class="plurk" href="https://yutaii.run/plurk" target="_blank"><img src="/images/community_logo/plurk.svg" alt="Plurk Logo" class="logo"/>yuutatsubasa</a></li>
                </ul>
            </nav> *@
        </section>
    </section>
</section>

<script>
    Date.prototype.getMMDDFormat = function() {
        var mm = this.getMonth() + 1; // getMonth() is zero-based
        var dd = this.getDate();

        return [(mm > 9 ? '' : '0') + mm,
                (dd > 9 ? '' : '0') + dd].join('/');
        };

    const memorize = function(){
        document.querySelectorAll("input, select").forEach(input => {
            localStorage.setItem(input.id, input.value);
        });
    }

    const updateWeekly = function(){
        const weekly = document.querySelector(".weekly");
        const backgroundColor = document.querySelector("#backgroundColor").value;
        weekly.style.backgroundColor = backgroundColor;

        const weeklyLeftPart = document.querySelector(".weekly_left_part");
        const coverArtUrl = document.querySelector("#coverArt").value;
        weeklyLeftPart.style.backgroundImage = coverArtUrl ? `url("${coverArtUrl}")` : "";

        const weeklyAuthorPart = document.querySelector(".weekly_author_part");
        const coverDescription = document.querySelector("#coverDescription").value;
        if (coverDescription) {
            weeklyAuthorPart.style.display = "block";
            weeklyAuthorPart.innerHTML = coverDescription;
        }
        else {
            weeklyAuthorPart.style.display = "none";
        }

        const startDate = new Date(document.querySelector("#startDate").value);
        let contents = [];
        for(let day = 1 ; day <= 7 ; ++day){
            let currentDate = new Date();
            currentDate.setDate(startDate.getDate() + (day - 1));
            contents.push({
                "date": currentDate,
                "title": document.querySelector(`#day${day}Title`).value,
                "style": document.querySelector(`#day${day}Style`).value,
                "tag": document.querySelector(`#day${day}Tag`).value,
                "time": document.querySelector(`#day${day}Time`).value,
            })
        }

        const options = { weekday: 'short'};
        const dayItems = document.querySelectorAll(".weekly_item");
        for(let day = 0; day < 7; ++day){
            dayItems[day].querySelector(".date_part").innerText = contents[day].date.getMMDDFormat();
            dayItems[day].querySelector(".time_part").innerText = 
                `(${new Intl.DateTimeFormat('zh-TW', options).format(contents[day].date)[1]}) ${contents[day].time}`;
            
            const content = dayItems[day].querySelector(".content");
            if (contents[day].style === "holiday"){
                if (!content.classList.contains("stream_off")){
                    content.classList.add("stream_off");
                }
            }
            else {
                if (content.classList.contains("stream_off")){
                    content.classList.remove("stream_off");
                }
            }

            content.innerHTML = "";
            if (contents[day].tag) {
                content.innerHTML += `<ul class="weekly_tags">`
                                  + contents[day].tag.split(",").map(tag => `<li>${tag}</li>`).join("")
                                  + `</ul>`;
            }
            content.innerHTML += contents[day].title;
        }

        memorize();
    }

    document.querySelectorAll("input, select").forEach(tag => {
        tag.addEventListener("change", updateWeekly); 
        const memorizedContent = localStorage.getItem(tag.id);
        if (memorizedContent) {
            tag.value = memorizedContent;
        }
    });

    updateWeekly();
</script>